# Dropship Books — Fullstack (React + Express) — Single Repo

This is a complete, working fullstack prototype that lets you search *every* book (Open Library), add to cart, and "checkout" (mocked dropship flow). It's designed to be production-ready enough for you to extend to real supplier APIs (Ingram, Baker & Taylor, Amazon SP-API, etc.).

Features
- React frontend (Vite) with Tailwind for clean UI
- Express backend with simple order endpoint (mocked supplier flow)
- Search via Open Library (no API key)
- Cart persistence (localStorage)
- Checkout creates an "order" on the backend (server logs it and returns a mock supplier link)
- Affiliate-ready buy links
- Clear instructions: run locally, deploy to Vercel / Render / Railway

---

## File tree

```
dropship-books/
├─ frontend/
│  ├─ package.json
│  ├─ vite.config.js
│  ├─ tailwind.config.cjs
│  ├─ postcss.config.cjs
│  ├─ index.html
│  └─ src/
│     ├─ main.jsx
│     ├─ App.jsx
│     ├─ index.css
│     ├─ components/
│     │  ├─ SearchBar.jsx
│     │  ├─ BookCard.jsx
│     │  └─ CartDrawer.jsx
│     └─ pages/
│        └─ Checkout.jsx
├─ backend/
│  ├─ package.json
│  └─ index.js
└─ README.md
```

---

## frontend/package.json

```json
{
  "name": "dropship-books-frontend",
  "version": "1.0.0",
  "private": true,
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "react": "18.2.0",
    "react-dom": "18.2.0",
    "axios": "1.4.0",
    "clsx": "1.2.1"
  },
  "devDependencies": {
    "vite": "5.1.0",
    "@vitejs/plugin-react": "4.0.0",
    "tailwindcss": "3.5.0",
    "postcss": "8.4.24",
    "autoprefixer": "10.4.14"
  }
}
```

---

## frontend/index.html

```html
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dropship Books</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
```

---

## frontend/src/main.jsx

```jsx
import React from 'react'
import { createRoot } from 'react-dom/client'
import App from './App'
import './index.css'

createRoot(document.getElementById('root')).render(<App />)
```

---

## frontend/src/index.css

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

html, body, #root { height: 100%; }
body { @apply bg-slate-50 text-slate-900; }
```

---

## frontend/src/App.jsx

```jsx
import React, { useState, useEffect } from 'react'
import axios from 'axios'
import SearchBar from './components/SearchBar'
import BookCard from './components/BookCard'
import CartDrawer from './components/CartDrawer'

export default function App() {
  const [results, setResults] = useState([])
  const [loading, setLoading] = useState(false)
  const [query, setQuery] = useState('')
  const [cart, setCart] = useState(() => {
    try { return JSON.parse(localStorage.getItem('cart') || '[]') } catch { return [] }
  })

  useEffect(() => { localStorage.setItem('cart', JSON.stringify(cart)) }, [cart])

  async function search(q) {
    if (!q) return
    setLoading(true)
    try {
      const res = await axios.get('https://openlibrary.org/search.json', { params: { q, limit: 20 } })
      const docs = res.data.docs || []
      const mapped = docs.map(d => ({
        key: d.key,
        title: d.title,
        author: d.author_name ? d.author_name.join(', ') : 'Unknown',
        year: d.first_publish_year || '-',
        coverId: d.cover_i || null
      }))
      setResults(mapped)
    } catch (e) {
      console.error(e)
    } finally {
      setLoading(false)
    }
  }

  function addToCart(book) {
    setCart(prev => {
      if (prev.find(x => x.key === book.key)) return prev
      return [...prev, { ...book, qty: 1 }]
    })
  }

  function updateQty(key, qty) {
    setCart(prev => prev.map(i => i.key === key ? { ...i, qty } : i))
  }

  function removeFromCart(key) {
    setCart(prev => prev.filter(i => i.key !== key))
  }

  async function checkout(shipping) {
    // shipping: { name, address, email }
    const order = { items: cart, shipping }
    const res = await axios.post('/api/create-order', order)
    return res.data
  }

  return (
    <div className="min-h-screen">
      <header className="max-w-6xl mx-auto p-6 flex justify-between items-center">
        <h1 className="text-2xl font-extrabold">Dropship Books</h1>
        <div className="flex gap-2">
          <CartDrawer cart={cart} updateQty={updateQty} removeFromCart={removeFromCart} checkout={checkout} />
        </div>
      </header>

      <main className="max-w-6xl mx-auto p-6">
        <SearchBar onSearch={q => { setQuery(q); search(q) }} />
        <div className="mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
          {loading && <div>Loading...</div>}
          {!loading && results.map(r => (
            <BookCard key={r.key} book={r} onAdd={() => addToCart(r)} />
          ))}
        </div>
      </main>
    </div>
  )
}
```

---

## frontend/src/components/SearchBar.jsx

```jsx
import React, { useState } from 'react'
export default function SearchBar({ onSearch }) {
  const [q, setQ] = useState('')
  return (
    <div className="flex gap-2">
      <input
        value={q}
        onChange={e => setQ(e.target.value)}
        onKeyDown={e => { if (e.key === 'Enter') onSearch(q) }}
        placeholder="Search title, author, ISBN..."
        className="flex-1 p-3 rounded-md border"
      />
      <button onClick={() => onSearch(q)} className="px-4 py-2 bg-blue-600 text-white rounded-md">Search</button>
    </div>
  )
}
```

---

## frontend/src/components/BookCard.jsx

```jsx
import React from 'react'

function coverUrl(id) { return id ? `https://covers.openlibrary.org/b/id/${id}-L.jpg` : null }

export default function BookCard({ book, onAdd }) {
  return (
    <div className="bg-white p-4 rounded shadow-sm flex gap-4">
      <div style={{ minWidth: 96 }}>
        {book.coverId ? <img src={coverUrl(book.coverId)} alt="cover" className="w-24 h-32 object-cover" /> : <div className="w-24 h-32 bg-gray-100 flex items-center justify-center text-xs">No Cover</div>}
      </div>
      <div className="flex-1">
        <h3 className="font-semibold">{book.title}</h3>
        <div className="text-sm text-gray-600">{book.author} • {book.year}</div>
        <div className="mt-3 flex gap-2">
          <button onClick={onAdd} className="px-2 py-1 bg-green-600 text-white rounded">Add to Cart</button>
          <a href={`https://www.amazon.com/s?k=${encodeURIComponent(book.title + ' ' + book.author)}`} target="_blank" rel="noreferrer" className="px-2 py-1 border rounded">Amazon</a>
        </div>
      </div>
    </div>
  )
}
```

---

## frontend/src/components/CartDrawer.jsx

```jsx
import React, { useState } from 'react'

export default function CartDrawer({ cart, updateQty, removeFromCart, checkout }) {
  const [open, setOpen] = useState(false)
  const [shipping, setShipping] = useState({ name: '', address: '', email: '' })
  const [processing, setProcessing] = useState(false)
  const [message, setMessage] = useState(null)

  async function doCheckout() {
    setProcessing(true)
    try {
      const res = await checkout(shipping)
      setMessage('Order created: ' + (res.orderId || 'OK'))
    } catch (e) {
      setMessage('Checkout failed')
    } finally { setProcessing(false) }
  }

  return (
    <div>
      <button onClick={() => setOpen(true)} className="px-3 py-2 border rounded">Cart ({cart.length})</button>

      {open && (
        <div className="fixed inset-0 z-50 bg-black/40 flex justify-end">
          <div className="w-full sm:w-96 bg-white p-4 h-full overflow-auto">
            <div className="flex justify-between items-center">
              <h2 className="font-semibold">Cart</h2>
              <button onClick={() => setOpen(false)}>Close</button>
            </div>

            <div className="mt-4 space-y-3">
              {cart.length === 0 && <div className="text-sm text-gray-500">No items</div>}
              {cart.map(item => (
                <div key={item.key} className="flex justify-between items-center">
                  <div>
                    <div className="text-sm font-medium">{item.title}</div>
                    <div className="text-xs text-gray-500">{item.author}</div>
                  </div>
                  <div className="flex items-center gap-2">
                    <input type="number" value={item.qty} min={1} onChange={e => updateQty(item.key, Number(e.target.value))} className="w-16 p-1 border rounded" />
                    <button onClick={() => removeFromCart(item.key)} className="px-2 py-1 border rounded">Remove</button>
                  </div>
                </div>
              ))}
            </div>

            <div className="mt-4">
              <h3 className="font-semibold">Shipping</h3>
              <input placeholder="Name" value={shipping.name} onChange={e => setShipping(s => ({ ...s, name: e.target.value }))} className="w-full p-2 mt-2 border rounded" />
              <input placeholder="Address" value={shipping.address} onChange={e => setShipping(s => ({ ...s, address: e.target.value }))} className="w-full p-2 mt-2 border rounded" />
              <input placeholder="Email" value={shipping.email} onChange={e => setShipping(s => ({ ...s, email: e.target.value }))} className="w-full p-2 mt-2 border rounded" />

              <button onClick={doCheckout} disabled={processing || cart.length===0} className="mt-3 w-full px-3 py-2 bg-blue-600 text-white rounded">{processing ? 'Processing...' : 'Place Order'}</button>
              {message && <div className="mt-2 text-sm">{message}</div>}
            </div>
          </div>
        </div>
      )}
    </div>
  )
}
```

---

## backend/package.json

```json
{
  "name": "dropship-books-backend",
  "version": "1.0.0",
  "main": "index.js",
  "scripts": { "start": "node index.js" },
  "dependencies": { "express": "4.18.2", "cors": "2.8.5", "body-parser": "1.20.2", "nanoid": "4.0.0" }
}
```

---

## backend/index.js

```js
const express = require('express')
const cors = require('cors')
const bodyParser = require('body-parser')
const { nanoid } = require('nanoid')

const app = express()
app.use(cors())
app.use(bodyParser.json())

// Simple health
app.get('/ping', (req, res) => res.json({ ok: true }))

// Create order endpoint (mock)
app.post('/api/create-order', (req, res) => {
  const { items, shipping } = req.body
  if (!items || items.length === 0) return res.status(400).json({ error: 'No items' })

  // In production: here you'd call your supplier APIs to create orders.
  // For the demo we create a mock order and return a supplier "link"
  const orderId = 'ORD-' + nanoid(8)
  console.log('New order:', { orderId, items, shipping, createdAt: new Date().toISOString() })

  // Example supplier response: a tracking link (mock)
  const supplierLinks = items.map(i => ({ title: i.title, supplierUrl: `https://example-supplier.com/order/${nanoid(6)}` }))

  res.json({ ok: true, orderId, supplierLinks })
})

const PORT = process.env.PORT || 4000
app.listen(PORT, () => console.log('Backend listening on', PORT))
```

---

## README.md (run & deploy)

```md
# Dropship Books — Fullstack Prototype

## Run locally

1. Clone repo
2. Start backend:
   ```bash
   cd backend
   npm install
   npm start
   ```
3. Start frontend (in a separate terminal):
   ```bash
   cd frontend
   npm install
   npm run dev
   ```
4. Proxy the frontend dev server to the backend in production or set a Vite proxy in vite.config.js. For local dev, add `"proxy": "http://localhost:4000"` to frontend/package.json or configure Vite dev server proxy.

## Deploy
- Option A (single deploy): Use Vercel and put backend in `api/` as serverless functions, frontend as app.
- Option B: Deploy backend to Render/Railway and frontend to Vercel/Netlify. Add a runtime environment variable `REACT_APP_API_URL`.

## Next steps to make this "real"
- Integrate a supplier (Ingram, Baker & Taylor, Amazon SP-API). Implement inventory sync & pricing rules.
- Add payments (Stripe) and order webhooks.
- Implement authentication & admin dashboard.
- Add rate limiting and order validation.

```

---

### Final notes
- This repo is intentionally modular so you can swap the mocked `/api/create-order` with real supplier API calls later.
- If you want, I can:
  - generate the actual repo files (zipped) for download, or
  - push the code to a GitHub repo I generate here (you'll need to provide a token or I'll give instructions you can copy/paste), or
  - connect to a chosen supplier and implement one integration (e.g., Ingram sample flow).

Tell me which of the three you'd like next and I will either create the zip, push to GitHub, or start the supplier integration.
